
package com.announcify.plugin.voice.mail.receiver;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;

import com.announcify.api.receiver.PluginReceiver;
import com.announcify.plugin.voice.mail.activity.SettingsActivity;
import com.announcify.plugin.voice.mail.service.VoicemailService;
import com.announcify.plugin.voice.mail.util.Settings;

public class AnnouncifyReceiver extends BroadcastReceiver {
    
    @Override
    public void onReceive(final Context context, final Intent intent) {
        final Settings settings = new Settings(context);

        final Intent respondIntent = new Intent(ACTION_PLUGIN_RESPOND);
        respondIntent.putExtra(EXTRA_PLUGIN_NAME, settings.getEventType());
        respondIntent.putExtra(EXTRA_PLUGIN_ACTION, SettingsActivity.ACTION_SETTINGS);
        respondIntent.putExtra(EXTRA_PLUGIN_PACKAGE, context.getPackageName());
        respondIntent.putExtra(EXTRA_PLUGIN_PRIORITY, settings.getPriority());
        context.sendBroadcast(respondIntent);

        final Intent serviceIntent = new Intent(context, VoicemailService.class);
        context.stopService(serviceIntent);
        context.startService(serviceIntent);
    }
}
