function announcify(data) {
	var text = "";
	if (data[0].fullcount == 1) {
		text = data[0].fullcount + " new mail!";
	} else {
		text = data[0].fullcount + " new mails!";
	}

	var speech = document.getElementById("speech");
	speech.setAttribute("src", "http://translate.google.com/translate_tts?tl=en&q=" + encodeURIComponent(text));
}

function checkMails() {
		var request = new XMLHttpRequest();
		request.onreadystatechange = function() {
				
		if (request.readyState == 4) {
			if (request.status == 200) {
				var token = request.responseText;
				if (token == null || token == "") return;
	
				var json = JSON.parse(token);
				announcify(json);
			} else {
				// error
			}
		}
	}
				
	request.open("GET", "https://announcify.appspot.com/gmail" + appendToken(), true);
	request.send();
}