package com.announcify.api.background.contact.lookup;

import java.util.LinkedList;

import android.content.Context;
import android.database.Cursor;
import android.provider.ContactsContract.CommonDataKinds.GroupMembership;
import android.provider.ContactsContract.Data;
import android.util.Log;

import com.announcify.api.background.contact.Contact;

public class Group {

    public static void getGroups(final Context context, final Contact contact) {
        Cursor cursor = null;

        try {
            cursor = context.getContentResolver().query(
                    Data.CONTENT_URI,
                    new String[] { GroupMembership.GROUP_ROW_ID },
                    Data.MIMETYPE + " = ? AND " + GroupMembership.LOOKUP_KEY
                            + " = ?",
                    new String[] { GroupMembership.CONTENT_ITEM_TYPE,
                            contact.getLookupString() }, null);

            final LinkedList<Long> groups = new LinkedList<Long>();

            while (cursor.moveToNext()) {
                Log.e("smn3", "." + cursor.getLong(0));
                groups.add(cursor.getLong(0));
            }

            contact.setGroups(groups);
        } finally {
            if (cursor != null) {
                cursor.close();
            }
        }
    }
}
