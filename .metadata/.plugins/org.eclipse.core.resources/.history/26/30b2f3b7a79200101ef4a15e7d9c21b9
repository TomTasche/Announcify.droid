<!DOCTYPE HTML>
<html>
	<head>
		<title>Announcify for Google Chrome</title>
		
<!--		<script type="text/javascript" src="announcify_credential.js"></script>-->
<!--		<script type="text/javascript" src="announcify_gmail.js"></script>-->
<!--		<script type="text/javascript" src="channel.js"></script>-->
		<script type="text/javascript">
			function login() {
	  			if (!isTokenAvailable("appengine")) {
	  				chrome.tabs.create({url: "https://announcify.appspot.com/appengine/login"});
	  			} else if (!isTokenAvailable("gmail")) {
	  				chrome.tabs.create({url: "https://announcify.appspot.com/gmail/login"});
	  			} else {
	  				return true;
	  			}
	  			
	  			return false;
	  		}

		
			function onRequest(request, sender, callback) {
				saveToken(request);
				
				checkMails();
      		}

			chrome.extension.onRequest.addListener(onRequest);

			function onClickAction() {
				if (login()) {
      				// checkMails();
      				
      				console.log("logged in");
      			} else {
      				console.log("not logged in");
      			}
      		}
			
			chrome.browserAction.onClicked.addListener(function (tab) {
				onClickAction();
			});
      		
      		// setInterval(checkMails, 600000);
		</script>
	</head>
	
<!--	<body onload="checkMails();">-->
	<body>
		<audio id="speech" controls="controls" autoplay="autoplay">Your browser does not support the audio element.</audio>
	</body>
</html>
