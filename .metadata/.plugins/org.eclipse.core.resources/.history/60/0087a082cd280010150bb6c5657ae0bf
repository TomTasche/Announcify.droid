
package com.announcify.api.background.service;

import com.announcify.api.background.util.PluginSettings;
import com.announcify.plugin.voice.call.activity.SettingsActivity;
import com.announcify.plugin.voice.call.util.Settings;

import android.app.IntentService;
import android.content.Intent;

public abstract class PluginService extends IntentService {
    public static final String ACTION_PLUGIN_CONTACT = "com.announcify.ACTION_PLUGIN_CONTACT";
    
    public static final String ACTION_ANNOUNCE = "com.announcify.ANNOUNCE";

    public static final String EXTRA_PRIORITY = "com.announcify.EXTRA_PRIORITY";

    public static final String EXTRA_QUEUE = "com.announcify.EXTRA_QUEUE";
    
    protected PluginSettings settings;

    public PluginService(final String name) {
        super(name);
    }

    @Override
    protected void onHandleIntent(Intent intent) {
        if (ACTION_PLUGIN_CONTACT.equals(intent.getAction())) {
            final Settings settings = new Settings(context);

            final Intent respondIntent = new Intent(ACTION_PLUGIN_RESPOND);
            respondIntent.putExtra(EXTRA_PLUGIN_NAME, settings.getEventType());
            respondIntent.putExtra(EXTRA_PLUGIN_ACTION, SettingsActivity.ACTION_SETTINGS);
            respondIntent.putExtra(EXTRA_PLUGIN_PACKAGE, context.getPackageName());
            respondIntent.putExtra(EXTRA_PLUGIN_PRIORITY, settings.getPriority());
            context.sendBroadcast(respondIntent);
        }
    }
}
